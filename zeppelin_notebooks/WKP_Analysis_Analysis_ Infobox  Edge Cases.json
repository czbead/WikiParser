{"paragraphs":[{"text":"%spark\nimport org.apache.spark.sql.SparkSession\n\nval spark = SparkSession.builder.getOrCreate()","user":"anonymous","dateUpdated":"2019-09-05T14:47:35-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567707062925_1353889507","id":"20190905-111102_220543537","dateCreated":"2019-09-05T11:11:02-0700","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:12058"},{"text":"%spark\nval wk_text = spark.read.parquet(\"hdfs:///folder/ ... /wiki_text_parquet/\")\nwk_text.count\nwk_text.printSchema\nwk_text.show","user":"anonymous","dateUpdated":"2019-09-05T14:48:24-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567720097921_-3919737","id":"20190905-144817_1646014664","dateCreated":"2019-09-05T14:48:17-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12059"},{"text":"%spark\ndef getSpeInfoLines(keyWord: String): (String => List[String]) = { wikitext => \n\tif (null == wikitext) {\n\t\tnull\n\t} else {\n\t\tval text = wikitext.trim.toLowerCase\n\t\tif (!(text contains keyWord)) {\n\t\t\tnull\n\t\t} else {\n\t\t\tval lines = text.split(\"\\n\").toList\n\t\t\tval hasInfoLines = lines.filter(_ contains keyWord) \n\t\t\tval speInfoLines = hasInfoLines.filter( line => {\n\t\t\t\tval lineStr = line.trim.replaceAll(\" +\", \"\")\n\t\t\t\t!lineStr.startsWith(\"{{infobox\") && !lineStr.startsWith(\"<!\") && !lineStr.startsWith(\"{|class=\\\"infobox\\\"\") && !(lineStr contains \"{{infobox\") && \n\t\t\t\t!(lineStr contains \"{|class=\\\"infobox\\\"\")\n\t\t\t})\n\t\t\tif (speInfoLines.isEmpty) {\n\t\t\t\tnull\n\t\t\t} else {\n\t\t\t\tspeInfoLines\n\t\t\t}\n\t\t}\n\t}\n}\n\nval infoboxKeyWord = \"infobox\"\nval extSpeInfoLines = udf(getSpeInfoLines(infoboxKeyWord))","user":"anonymous","dateUpdated":"2019-09-05T14:48:34-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567720097626_595689183","id":"20190905-144817_119659512","dateCreated":"2019-09-05T14:48:17-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12060"},{"text":"%spark\nval wk_spe_info = wk_text.withColumn(\"spe_info_line\", extSpeInfoLines($\"rev_text\"))\nwk_spe_info.count\nwk_spe_info.printSchema\nwk_spe_info.show","user":"anonymous","dateUpdated":"2019-09-05T14:48:42-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567720096450_-748756376","id":"20190905-144816_1500090876","dateCreated":"2019-09-05T14:48:16-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12061"},{"text":"%spark\nval checkSpeInfo = wk_spe_info.select(\"spe_info_line\").filter($\"spe_info_line\".isNotNull)\ncheckSpeInfo.count\ncheckSpeInfo.show(200, false)","user":"anonymous","dateUpdated":"2019-09-05T14:48:54-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567720095910_-1015087802","id":"20190905-144815_1882045218","dateCreated":"2019-09-05T14:48:15-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12062"},{"text":"%spark\n","user":"anonymous","dateUpdated":"2019-09-05T14:48:54-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567720134442_502083148","id":"20190905-144854_630207056","dateCreated":"2019-09-05T14:48:54-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:12063"}],"name":"WKP/Analysis/Analysis: Infobox  Edge Cases","id":"2EPMT37FK","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}