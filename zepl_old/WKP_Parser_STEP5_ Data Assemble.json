{"paragraphs":[{"text":"%spark\nimport org.apache.spark.sql.SparkSession\n\nval spark = SparkSession.builder.getOrCreate()","user":"anonymous","dateUpdated":"2019-09-05T14:42:36-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567707008149_2110142447","id":"20190905-111008_1247292652","dateCreated":"2019-09-05T11:10:08-0700","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:8451"},{"text":"%spark\n// val wk_xml = spark.read.parquet(\"hdfs://localhost:9000/data/wiki/wk_xml_parquet/\")\nwk_xml.count\nwk_xml.printSchema\nwk_xml.show","user":"anonymous","dateUpdated":"2019-09-13T10:43:17-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567719758262_664244548","id":"20190905-144238_1031068087","dateCreated":"2019-09-05T14:42:38-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8452"},{"text":"%spark\n// val wk_struct = spark.read.parquet(\"hdfs://localhost:9000/data/wiki/wk_struct_parquet/\")\nwk_struct.count\nwk_struct.printSchema\nwk_struct.show","user":"anonymous","dateUpdated":"2019-09-13T10:43:22-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567719757895_1445021522","id":"20190905-144237_2022609853","dateCreated":"2019-09-05T14:42:37-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8453"},{"text":"%spark\n// val wk_skeleton = spark.read.parquet(\"hdfs://localhost:9000/data/wiki/wk_skelenton_parquet/\")\nwk_ske.count\nwk_ske.printSchema\nwk_ske.show","user":"anonymous","dateUpdated":"2019-09-19T20:14:05-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1568396517450_1349034354","id":"20190913-104157_828514065","dateCreated":"2019-09-13T10:41:57-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8454"},{"text":"%spark\nval wk_struct_clean = wk_struct.drop(\"rev_id\", \"rev_text\")\n// wk_struct_clean.count\n// wk_struct_clean.printSchema\n// wk_struct_clean.show","user":"anonymous","dateUpdated":"2019-09-23T16:20:26-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wk_struct_clean: org.apache.spark.sql.DataFrame = [id: bigint, unclosed: boolean ... 16 more fields]\n"}]},"apps":[],"jobName":"paragraph_1567719757550_-37868569","id":"20190905-144237_2016987352","dateCreated":"2019-09-05T14:42:37-0700","dateStarted":"2019-09-23T16:42:41-0700","dateFinished":"2019-09-23T16:42:41-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8455"},{"text":"%spark\nval wk_ske_clean = wk_skeleton.drop(\"rev_id\", \"rev_text\", \"level_bad\")\n// wk_ske_clean.count\n// wk_ske_clean.printSchema\n// wk_ske_clean.show","user":"anonymous","dateUpdated":"2019-09-23T16:20:28-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wk_ske_clean: org.apache.spark.sql.DataFrame = [id: bigint, heading_raw: array<string> ... 5 more fields]\n"}]},"apps":[],"jobName":"paragraph_1568396629317_1108101784","id":"20190913-104349_1424661243","dateCreated":"2019-09-13T10:43:49-0700","dateStarted":"2019-09-23T16:42:41-0700","dateFinished":"2019-09-23T16:42:42-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8456"},{"text":"%spark\nval wk_xml_rp = wk_xml.repartition(1)\nval wk_struct_rp = wk_struct_clean.repartition(1)\nval wk_ske_rp = wk_ske_clean.repartition(1)\nval wk_merge_tmp = wk_xml_rp.join(wk_struct_rp, \"id\")\nval wk_merged = wk_merge_tmp.join(wk_ske_rp, \"id\")\n// wk_merged.count\n// wk_merged.printSchema\n// wk_merged.show\n","user":"anonymous","dateUpdated":"2019-09-23T16:20:30-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wk_xml_rp: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: bigint, title: string ... 16 more fields]\nwk_struct_rp: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: bigint, unclosed: boolean ... 16 more fields]\nwk_ske_rp: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: bigint, heading_raw: array<string> ... 5 more fields]\nwk_merge_tmp: org.apache.spark.sql.DataFrame = [id: bigint, title: string ... 33 more fields]\nwk_merged: org.apache.spark.sql.DataFrame = [id: bigint, title: string ... 39 more fields]\n"}]},"apps":[],"jobName":"paragraph_1567719756230_1043253675","id":"20190905-144236_405516655","dateCreated":"2019-09-05T14:42:36-0700","dateStarted":"2019-09-23T16:42:42-0700","dateFinished":"2019-09-23T16:42:42-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8457"},{"text":"%spark\nval wk_unique = wk_merged.filter($\"redirect\".isNull)\nval uniqueCount = wk_unique.count","user":"anonymous","dateUpdated":"2019-09-23T16:20:35-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wk_unique: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: bigint, title: string ... 39 more fields]\nuniqueCount: Long = 10407364\n"}]},"runtimeInfos":{"jobUrl":{"propertyName":"jobUrl","label":"SPARK JOB","tooltip":"View in Spark web UI","group":"spark","values":["http://192.168.1.154:4040/jobs/job?id=3"],"interpreterSettingId":"spark"}},"apps":[],"jobName":"paragraph_1569269826619_-629556911","id":"20190923-131706_1422543124","dateCreated":"2019-09-23T13:17:06-0700","dateStarted":"2019-09-23T16:42:42-0700","dateFinished":"2019-09-23T17:29:22-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8458"},{"text":"%spark\nval wk_hasbox = wk_unique.filter($\"infobox\".isNotNull)\nval hasBoxCount = wk_hasbox.count\nwk_hasbox.printSchema\nwk_hasbox.show","user":"anonymous","dateUpdated":"2019-09-26T11:10:38-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"wk_hasbox: org.apache.spark.sql.Dataset[org.apache.spark.sql.Row] = [id: bigint, title: string ... 39 more fields]\n"}]},"apps":[],"jobName":"paragraph_1567719801583_1301546018","id":"20190905-144321_2136416578","dateCreated":"2019-09-05T14:43:21-0700","dateStarted":"2019-09-23T16:42:43-0700","dateFinished":"2019-09-23T17:29:22-0700","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:8459"},{"text":"%spark\nwk_merged.write.mode(\"overwrite\").parquet(\"hdfs://localhost:9000/data/wiki/wk_merged_parquet/\")\nwk_hasbox.write.mode(\"overwrite\").parquet(\"hdfs://localhost:9000/data/wiki/wk_hasbox_parquet/\")","user":"anonymous","dateUpdated":"2019-09-13T10:46:53-0700","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"scala","editOnDblClick":false,"completionKey":"TAB","completionSupport":true},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1567719810695_801481357","id":"20190905-144330_1805594794","dateCreated":"2019-09-05T14:43:30-0700","status":"READY","progressUpdateIntervalMs":500,"$$hashKey":"object:8460"}],"name":"WKP/Parser/STEP5: Data Assemble","id":"2EK962NXK","noteParams":{},"noteForms":{},"angularObjects":{"spark:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}